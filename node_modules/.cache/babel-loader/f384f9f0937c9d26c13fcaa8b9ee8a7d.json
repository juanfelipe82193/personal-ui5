{"ast":null,"code":"import UI5Element from \"@ui5/webcomponents-base/dist/UI5Element.js\";\nimport { getFirstFocusableElement, getLastFocusableElement } from \"@ui5/webcomponents-base/dist/util/FocusableElements.js\";\nimport Integer from \"@ui5/webcomponents-base/dist/types/Integer.js\";\nimport { isEscape } from \"@ui5/webcomponents-base/dist/Keys.js\"; // Styles\n\nimport styles from \"./generated/themes/Popup.css.js\";\nimport { addOpenedPopup, removeOpenedPopup } from \"./popup-utils/OpenedPopupsRegistry.js\";\nimport { getNextZIndex } from \"./popup-utils/PopupUtils.js\";\n/**\n * @public\n */\n\nconst metadata = {\n  managedSlots: true,\n  slots:\n  /** @lends  sap.ui.webcomponents.main.Popup.prototype */\n  {\n    /**\n     * Defines the content of the Web Component.\n     * @type {Node[]}\n     * @slot\n     * @public\n     */\n    \"default\": {\n      type: HTMLElement\n    },\n\n    /**\n     * Defines the header HTML Element.\n     *\n     * @type {HTMLElement[]}\n     * @slot\n     * @public\n     */\n    header: {\n      type: HTMLElement\n    },\n\n    /**\n     * Defines the footer HTML Element.\n     *\n     * @type {HTMLElement[]}\n     * @slot\n     * @public\n     */\n    footer: {\n      type: HTMLElement\n    }\n  },\n  properties:\n  /** @lends  sap.ui.webcomponents.main.Popup.prototype */\n  {\n    /**\n     * Defines the ID of the HTML Element, which will get the initial focus.\n     *\n     * @type {string}\n     * @defaultvalue \"\"\n     * @public\n     */\n    initialFocus: {\n      type: String\n    },\n\n    /**\n     * Defines the header text.\n     * <br><br>\n     * <b>Note:</b> If <code>header</code> slot is provided, the <code>headerText</code> is ignored.\n     *\n     * @type {string}\n     * @defaultvalue \"\"\n     * @public\n     */\n    headerText: {\n      type: String\n    },\n\n    /**\n     * Indicates if the elements is on focus\n     * @private\n     */\n    opened: {\n      type: Boolean\n    },\n    _zIndex: {\n      type: Integer,\n      noAttribute: true\n    },\n    _hideBlockLayer: {\n      type: Boolean,\n      noAttribute: true\n    },\n\n    /**\n     * @private\n     */\n    _disableInitialFocus: {\n      type: Boolean\n    }\n  },\n  events:\n  /** @lends  sap.ui.webcomponents.main.Popup.prototype */\n  {\n    /**\n     * Fired before the component is opened.\n     *\n     * @public\n     * @event\n     */\n    beforeOpen: {},\n\n    /**\n     * Fired after the component is opened.\n     *\n     * @public\n     * @event\n     */\n    afterOpen: {},\n\n    /**\n     * Fired before the component is closed.\n     *\n     * @public\n     * @event\n     * @param {Boolean} escPressed Indicates that <code>ESC</code> key has triggered the event.\n     */\n    beforeClose: {\n      escPressed: {\n        type: Boolean\n      }\n    },\n\n    /**\n     * Fired after the component is closed.\n     *\n     * @public\n     * @event\n     */\n    afterClose: {}\n  }\n};\nconst openedPopups = [];\nlet isBodyScrollingDisabled = false;\nlet customBLyBackStyleInserted = false;\n\nfunction getParentHost(node) {\n  while (node && !node.host) {\n    node = node.parentNode;\n  }\n\n  return node && node.host;\n}\n\nfunction createBLyBackStyle() {\n  if (customBLyBackStyleInserted) {\n    return;\n  }\n\n  customBLyBackStyleInserted = true;\n  const bodyStyleSheet = document.createElement(\"style\");\n  bodyStyleSheet.type = \"text/css\";\n  bodyStyleSheet.innerHTML = `\n\t\t.ui5-popup-BLy--back {\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tposition: fixed;\n\t\t\toverflow: hidden;\n\t\t}\n\t`;\n  document.head.appendChild(bodyStyleSheet);\n}\n\nfunction updateBlockLayers() {\n  let popup,\n      i,\n      hasModal = false;\n\n  for (i = openedPopups.length - 1; i >= 0; i--) {\n    popup = openedPopups[i];\n\n    if (hasModal) {\n      popup._hideBlockLayer = true;\n    } else {\n      if (popup.isModal()) {\n        // eslint-disable-line\n        popup._hideBlockLayer = false;\n        hasModal = true;\n      }\n    }\n  }\n\n  updateBodyScrolling(hasModal);\n}\n\nfunction updateBodyScrolling(hasModal) {\n  if (isBodyScrollingDisabled === hasModal) {\n    return;\n  }\n\n  createBLyBackStyle();\n\n  if (hasModal) {\n    addBodyStyles();\n  } else {\n    removeBodyStyles();\n  }\n\n  isBodyScrollingDisabled = hasModal;\n}\n\nfunction addBodyStyles() {\n  document.body.style.top = `-${window.pageYOffset}px`;\n  document.body.classList.add(\"ui5-popup-BLy--back\");\n}\n\nfunction removeBodyStyles() {\n  document.body.classList.remove(\"ui5-popup-BLy--back\");\n  window.scrollTo(0, -parseFloat(document.body.style.top));\n  document.body.style.top = \"\";\n}\n/**\n * @class\n * <h3 class=\"comment-api-title\">Overview</h3>\n * Represents a base class for all popup Web Components.\n *\n * @constructor\n * @author SAP SE\n * @alias sap.ui.webcomponents.main.Popup\n * @extends sap.ui.webcomponents.base.UI5Element\n * @public\n */\n\n\nclass Popup extends UI5Element {\n  static get metadata() {\n    return metadata;\n  }\n\n  static get styles() {\n    return styles;\n  }\n\n  static hitTest(popup, event) {\n    const indexOf = openedPopups.indexOf(popup);\n    let openedPopup;\n\n    for (let i = indexOf; i < openedPopups.length; i++) {\n      openedPopup = openedPopups[i];\n\n      if (openedPopup.hitTest(event)) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  static hasModalPopup() {\n    for (let i = 0; i < openedPopups.length; i++) {\n      if (openedPopups[i].isModal()) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  constructor() {\n    super();\n    this._documentKeyDownHandler = this.documentKeyDown.bind(this);\n  }\n\n  isTopPopup() {\n    return openedPopups.indexOf(this) === openedPopups.length - 1;\n  }\n\n  isModal() {\n    return true;\n  }\n\n  documentKeyDown(event) {\n    if (isEscape(event) && this.isTopPopup()) {\n      this.escPressed = true;\n      this.close();\n    }\n  }\n\n  getPopupDomRef() {\n    const domRef = this.getDomRef();\n    return domRef && domRef.querySelector(\".ui5-popup-root\");\n  }\n\n  hitTest(_event) {\n    return true;\n  }\n\n  open() {\n    this.fireEvent(\"beforeOpen\", {});\n    this._isFirstTimeRendered = false;\n    this._zIndex = getNextZIndex();\n    openedPopups.push(this);\n    addOpenedPopup(this);\n    updateBlockLayers();\n  }\n\n  close() {\n    this.fireEvent(\"beforeClose\", {\n      escPressed: this.escPressed\n    }, true);\n    this.escPressed = false;\n    const index = openedPopups.indexOf(this);\n    openedPopups.splice(index, 1);\n\n    if (this.opened) {\n      removeOpenedPopup(this);\n    }\n\n    updateBlockLayers();\n  }\n\n  initInitialFocus() {\n    const initialFocus = this.initialFocus;\n    let initialFocusDomRef = this.initialFocus;\n\n    if (initialFocus && typeof initialFocus === \"string\") {\n      initialFocusDomRef = document.getElementById(initialFocus);\n\n      if (!initialFocusDomRef) {\n        const parentHost = getParentHost(this);\n\n        if (parentHost) {\n          initialFocusDomRef = parentHost.shadowRoot.querySelector(`#${initialFocus}`);\n        }\n      }\n    }\n\n    this._initialFocusDomRef = initialFocusDomRef;\n  }\n\n  onFirstTimeAfterRendering() {\n    if (this.isTopPopup()) {\n      this.initInitialFocus();\n      this.setInitialFocus(this.getPopupDomRef());\n    }\n\n    this.fireEvent(\"afterOpen\", {});\n  }\n\n  onAfterRendering() {\n    if (!this.opened) {\n      return;\n    }\n\n    if (!this._isFirstTimeRendered) {\n      this.onFirstTimeAfterRendering();\n      this._isFirstTimeRendered = true;\n    }\n  }\n\n  setInitialFocus(container) {\n    if (this._disableInitialFocus) {\n      return;\n    }\n\n    if (this._initialFocusDomRef) {\n      if (this._initialFocusDomRef !== document.activeElement) {\n        this._initialFocusDomRef.focus();\n      }\n\n      return;\n    }\n\n    if (!container) {\n      return;\n    }\n\n    const focusableElement = getFirstFocusableElement(container);\n\n    if (focusableElement) {\n      focusableElement.focus();\n    } else {\n      container.focus();\n    }\n  }\n\n  _onfocusin(event) {\n    this.preserveFocus(event, this.getPopupDomRef());\n  }\n\n  preserveFocus(event, container) {\n    if (!this.isTopPopup()) {\n      return;\n    }\n\n    let target = event.target;\n\n    while (target.shadowRoot && target.shadowRoot.activeElement) {\n      target = target.shadowRoot.activeElement;\n    }\n\n    let focusableElement;\n    let isSpecialCase = false;\n\n    switch (target.id) {\n      case `${this._id}-firstfe`:\n        focusableElement = getLastFocusableElement(container);\n        isSpecialCase = true;\n        break;\n\n      case `${this._id}-lastfe`:\n        focusableElement = getFirstFocusableElement(container);\n        isSpecialCase = true;\n        break;\n\n      case `${this._id}-blocklayer`:\n        focusableElement = this._currentFocusedElement || getFirstFocusableElement(container);\n        isSpecialCase = true;\n        break;\n    }\n\n    if (focusableElement) {\n      focusableElement.focus();\n    } else if (isSpecialCase) {\n      container.focus();\n    }\n\n    this._currentFocusedElement = focusableElement || document.activeElement;\n  }\n\n  storeCurrentFocus() {\n    let element = document.activeElement;\n\n    while (element.shadowRoot && element.shadowRoot.activeElement) {\n      element = element.shadowRoot.activeElement;\n    }\n\n    this._lastFocusableElement = element && typeof element.focus === \"function\" ? element : null;\n  }\n\n  resetFocus() {\n    if (!this._lastFocusableElement) {\n      return;\n    }\n\n    const lastFocusableElement = this._lastFocusableElement;\n\n    if (lastFocusableElement) {\n      lastFocusableElement.focus();\n    }\n\n    this._lastFocusableElement = null;\n  }\n\n  onExitDOM() {\n    removeBodyStyles();\n  }\n\n  get hasHeader() {\n    const hasHeaderText = this.headerText && this.headerText.length;\n    return !!(hasHeaderText || this.header.length);\n  }\n\n  get hasFooter() {\n    return !!this.footer.length;\n  }\n\n  get role() {\n    return \"heading\";\n  }\n\n}\n\nexport default Popup;","map":{"version":3,"sources":["/Users/juanzorrilla/Documents/SAPUI5/personal-ui5/node_modules/@ui5/webcomponents/dist/Popup.js"],"names":["UI5Element","getFirstFocusableElement","getLastFocusableElement","Integer","isEscape","styles","addOpenedPopup","removeOpenedPopup","getNextZIndex","metadata","managedSlots","slots","type","HTMLElement","header","footer","properties","initialFocus","String","headerText","opened","Boolean","_zIndex","noAttribute","_hideBlockLayer","_disableInitialFocus","events","beforeOpen","afterOpen","beforeClose","escPressed","afterClose","openedPopups","isBodyScrollingDisabled","customBLyBackStyleInserted","getParentHost","node","host","parentNode","createBLyBackStyle","bodyStyleSheet","document","createElement","innerHTML","head","appendChild","updateBlockLayers","popup","i","hasModal","length","isModal","updateBodyScrolling","addBodyStyles","removeBodyStyles","body","style","top","window","pageYOffset","classList","add","remove","scrollTo","parseFloat","Popup","hitTest","event","indexOf","openedPopup","hasModalPopup","constructor","_documentKeyDownHandler","documentKeyDown","bind","isTopPopup","close","getPopupDomRef","domRef","getDomRef","querySelector","_event","open","fireEvent","_isFirstTimeRendered","push","index","splice","initInitialFocus","initialFocusDomRef","getElementById","parentHost","shadowRoot","_initialFocusDomRef","onFirstTimeAfterRendering","setInitialFocus","onAfterRendering","container","activeElement","focus","focusableElement","_onfocusin","preserveFocus","target","isSpecialCase","id","_id","_currentFocusedElement","storeCurrentFocus","element","_lastFocusableElement","resetFocus","lastFocusableElement","onExitDOM","hasHeader","hasHeaderText","hasFooter","role"],"mappings":"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","sourcesContent":["import UI5Element from \"@ui5/webcomponents-base/dist/UI5Element.js\";\nimport { getFirstFocusableElement, getLastFocusableElement } from \"@ui5/webcomponents-base/dist/util/FocusableElements.js\";\nimport Integer from \"@ui5/webcomponents-base/dist/types/Integer.js\";\nimport { isEscape } from \"@ui5/webcomponents-base/dist/Keys.js\";\n\n// Styles\nimport styles from \"./generated/themes/Popup.css.js\";\n\nimport { addOpenedPopup, removeOpenedPopup } from \"./popup-utils/OpenedPopupsRegistry.js\";\nimport { getNextZIndex } from \"./popup-utils/PopupUtils.js\";\n\n/**\n * @public\n */\nconst metadata = {\n\tmanagedSlots: true,\n\tslots: /** @lends  sap.ui.webcomponents.main.Popup.prototype */ {\n\n\t\t/**\n\t\t * Defines the content of the Web Component.\n\t\t * @type {Node[]}\n\t\t * @slot\n\t\t * @public\n\t\t */\n\t\t\"default\": {\n\t\t\ttype: HTMLElement,\n\t\t},\n\n\t\t/**\n\t\t * Defines the header HTML Element.\n\t\t *\n\t\t * @type {HTMLElement[]}\n\t\t * @slot\n\t\t * @public\n\t\t */\n\t\theader: {\n\t\t\ttype: HTMLElement,\n\t\t},\n\n\t\t/**\n\t\t * Defines the footer HTML Element.\n\t\t *\n\t\t * @type {HTMLElement[]}\n\t\t * @slot\n\t\t * @public\n\t\t */\n\t\tfooter: {\n\t\t\ttype: HTMLElement,\n\t\t},\n\t},\n\tproperties: /** @lends  sap.ui.webcomponents.main.Popup.prototype */ {\n\t\t/**\n\t\t * Defines the ID of the HTML Element, which will get the initial focus.\n\t\t *\n\t\t * @type {string}\n\t\t * @defaultvalue \"\"\n\t\t * @public\n\t\t */\n\t\tinitialFocus: {\n\t\t\ttype: String,\n\t\t},\n\n\t\t/**\n\t\t * Defines the header text.\n\t\t * <br><br>\n\t\t * <b>Note:</b> If <code>header</code> slot is provided, the <code>headerText</code> is ignored.\n\t\t *\n\t\t * @type {string}\n\t\t * @defaultvalue \"\"\n\t\t * @public\n\t\t */\n\t\theaderText: {\n\t\t\ttype: String,\n\t\t},\n\n\t\t/**\n\t\t * Indicates if the elements is on focus\n\t\t * @private\n\t\t */\n\t\topened: {\n\t\t\ttype: Boolean,\n\t\t},\n\n\t\t_zIndex: {\n\t\t\ttype: Integer,\n\t\t\tnoAttribute: true,\n\t\t},\n\n\t\t_hideBlockLayer: {\n\t\t\ttype: Boolean,\n\t\t\tnoAttribute: true,\n\t\t},\n\n\t\t/**\n\t\t * @private\n\t\t */\n\t\t_disableInitialFocus: {\n\t\t\ttype: Boolean,\n\t\t},\n\t},\n\tevents: /** @lends  sap.ui.webcomponents.main.Popup.prototype */ {\n\n\t\t/**\n\t\t * Fired before the component is opened.\n\t\t *\n\t\t * @public\n\t\t * @event\n\t\t */\n\n\t\tbeforeOpen: {},\n\t\t/**\n\t\t * Fired after the component is opened.\n\t\t *\n\t\t * @public\n\t\t * @event\n\t\t */\n\n\t\tafterOpen: {},\n\t\t/**\n\t\t * Fired before the component is closed.\n\t\t *\n\t\t * @public\n\t\t * @event\n\t\t * @param {Boolean} escPressed Indicates that <code>ESC</code> key has triggered the event.\n\t\t */\n\n\t\tbeforeClose: {\n\t\t\tescPressed: { type: Boolean },\n\t\t},\n\n\t\t/**\n\t\t * Fired after the component is closed.\n\t\t *\n\t\t * @public\n\t\t * @event\n\t\t */\n\t\tafterClose: {},\n\t},\n};\n\nconst openedPopups = [];\nlet isBodyScrollingDisabled = false;\nlet customBLyBackStyleInserted = false;\n\nfunction getParentHost(node) {\n\twhile (node && !node.host) {\n\t\tnode = node.parentNode;\n\t}\n\n\treturn node && node.host;\n}\n\nfunction createBLyBackStyle() {\n\tif (customBLyBackStyleInserted) {\n\t\treturn;\n\t}\n\n\tcustomBLyBackStyleInserted = true;\n\n\tconst bodyStyleSheet = document.createElement(\"style\");\n\tbodyStyleSheet.type = \"text/css\";\n\tbodyStyleSheet.innerHTML = `\n\t\t.ui5-popup-BLy--back {\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tposition: fixed;\n\t\t\toverflow: hidden;\n\t\t}\n\t`;\n\tdocument.head.appendChild(bodyStyleSheet);\n}\n\nfunction updateBlockLayers() {\n\tlet popup,\n\t\ti,\n\t\thasModal = false;\n\n\tfor (i = openedPopups.length - 1; i >= 0; i--) {\n\t\tpopup = openedPopups[i];\n\t\tif (hasModal) {\n\t\t\tpopup._hideBlockLayer = true;\n\t\t} else {\n\t\t\tif (popup.isModal()) { // eslint-disable-line\n\t\t\t\tpopup._hideBlockLayer = false;\n\t\t\t\thasModal = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateBodyScrolling(hasModal);\n}\n\nfunction updateBodyScrolling(hasModal) {\n\tif (isBodyScrollingDisabled === hasModal) {\n\t\treturn;\n\t}\n\n\tcreateBLyBackStyle();\n\n\tif (hasModal) {\n\t\taddBodyStyles();\n\t} else {\n\t\tremoveBodyStyles();\n\t}\n\tisBodyScrollingDisabled = hasModal;\n}\n\nfunction addBodyStyles() {\n\tdocument.body.style.top = `-${window.pageYOffset}px`;\n\tdocument.body.classList.add(\"ui5-popup-BLy--back\");\n}\n\nfunction removeBodyStyles() {\n\tdocument.body.classList.remove(\"ui5-popup-BLy--back\");\n\twindow.scrollTo(0, -parseFloat(document.body.style.top));\n\tdocument.body.style.top = \"\";\n}\n\n/**\n * @class\n * <h3 class=\"comment-api-title\">Overview</h3>\n * Represents a base class for all popup Web Components.\n *\n * @constructor\n * @author SAP SE\n * @alias sap.ui.webcomponents.main.Popup\n * @extends sap.ui.webcomponents.base.UI5Element\n * @public\n */\nclass Popup extends UI5Element {\n\tstatic get metadata() {\n\t\treturn metadata;\n\t}\n\n\tstatic get styles() {\n\t\treturn styles;\n\t}\n\n\tstatic hitTest(popup, event) {\n\t\tconst indexOf = openedPopups.indexOf(popup);\n\t\tlet openedPopup;\n\n\t\tfor (let i = indexOf; i < openedPopups.length; i++) {\n\t\t\topenedPopup = openedPopups[i];\n\t\t\tif (openedPopup.hitTest(event)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic hasModalPopup() {\n\t\tfor (let i = 0; i < openedPopups.length; i++) {\n\t\t\tif (openedPopups[i].isModal()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._documentKeyDownHandler = this.documentKeyDown.bind(this);\n\t}\n\n\tisTopPopup() {\n\t\treturn openedPopups.indexOf(this) === openedPopups.length - 1;\n\t}\n\n\tisModal() {\n\t\treturn true;\n\t}\n\n\tdocumentKeyDown(event) {\n\t\tif (isEscape(event) && this.isTopPopup()) {\n\t\t\tthis.escPressed = true;\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\tgetPopupDomRef() {\n\t\tconst domRef = this.getDomRef();\n\t\treturn domRef && domRef.querySelector(\".ui5-popup-root\");\n\t}\n\n\thitTest(_event) {\n\t\treturn true;\n\t}\n\n\topen() {\n\t\tthis.fireEvent(\"beforeOpen\", { });\n\n\t\tthis._isFirstTimeRendered = false;\n\n\t\tthis._zIndex = getNextZIndex();\n\t\topenedPopups.push(this);\n\t\taddOpenedPopup(this);\n\n\n\t\tupdateBlockLayers();\n\t}\n\n\tclose() {\n\t\tthis.fireEvent(\"beforeClose\", {\n\t\t\tescPressed: this.escPressed,\n\t\t}, true);\n\n\t\tthis.escPressed = false;\n\n\t\tconst index = openedPopups.indexOf(this);\n\t\topenedPopups.splice(index, 1);\n\n\t\tif (this.opened) {\n\t\t\tremoveOpenedPopup(this);\n\t\t}\n\n\t\tupdateBlockLayers();\n\t}\n\n\tinitInitialFocus() {\n\t\tconst initialFocus = this.initialFocus;\n\t\tlet initialFocusDomRef = this.initialFocus;\n\n\t\tif (initialFocus && typeof initialFocus === \"string\") {\n\t\t\tinitialFocusDomRef = document.getElementById(initialFocus);\n\n\t\t\tif (!initialFocusDomRef) {\n\t\t\t\tconst parentHost = getParentHost(this);\n\t\t\t\tif (parentHost) {\n\t\t\t\t\tinitialFocusDomRef = parentHost.shadowRoot.querySelector(`#${initialFocus}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._initialFocusDomRef = initialFocusDomRef;\n\t}\n\n\tonFirstTimeAfterRendering() {\n\t\tif (this.isTopPopup()) {\n\t\t\tthis.initInitialFocus();\n\t\t\tthis.setInitialFocus(this.getPopupDomRef());\n\t\t}\n\n\t\tthis.fireEvent(\"afterOpen\", {});\n\t}\n\n\tonAfterRendering() {\n\t\tif (!this.opened) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._isFirstTimeRendered) {\n\t\t\tthis.onFirstTimeAfterRendering();\n\t\t\tthis._isFirstTimeRendered = true;\n\t\t}\n\t}\n\n\tsetInitialFocus(container) {\n\t\tif (this._disableInitialFocus) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._initialFocusDomRef) {\n\t\t\tif (this._initialFocusDomRef !== document.activeElement) {\n\t\t\t\tthis._initialFocusDomRef.focus();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tif (!container) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focusableElement = getFirstFocusableElement(container);\n\n\t\tif (focusableElement) {\n\t\t\tfocusableElement.focus();\n\t\t} else {\n\t\t\tcontainer.focus();\n\t\t}\n\t}\n\n\t_onfocusin(event) {\n\t\tthis.preserveFocus(event, this.getPopupDomRef());\n\t}\n\n\tpreserveFocus(event, container) {\n\t\tif (!this.isTopPopup()) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet target = event.target;\n\n\t\twhile (target.shadowRoot && target.shadowRoot.activeElement) {\n\t\t\ttarget = target.shadowRoot.activeElement;\n\t\t}\n\n\t\tlet focusableElement;\n\t\tlet isSpecialCase = false;\n\n\t\tswitch (target.id) {\n\t\tcase `${this._id}-firstfe`:\n\t\t\tfocusableElement = getLastFocusableElement(container);\n\t\t\tisSpecialCase = true;\n\t\t\tbreak;\n\t\tcase `${this._id}-lastfe`:\n\t\t\tfocusableElement = getFirstFocusableElement(container);\n\t\t\tisSpecialCase = true;\n\t\t\tbreak;\n\t\tcase `${this._id}-blocklayer`:\n\t\t\tfocusableElement = this._currentFocusedElement\n\t\t\t\t|| getFirstFocusableElement(container);\n\t\t\tisSpecialCase = true;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (focusableElement) {\n\t\t\tfocusableElement.focus();\n\t\t} else if (isSpecialCase) {\n\t\t\tcontainer.focus();\n\t\t}\n\n\t\tthis._currentFocusedElement = focusableElement || document.activeElement;\n\t}\n\n\tstoreCurrentFocus() {\n\t\tlet element = document.activeElement;\n\n\t\twhile (element.shadowRoot && element.shadowRoot.activeElement) {\n\t\t\telement = element.shadowRoot.activeElement;\n\t\t}\n\n\t\tthis._lastFocusableElement = (element && typeof element.focus === \"function\") ? element : null;\n\t}\n\n\tresetFocus() {\n\t\tif (!this._lastFocusableElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst lastFocusableElement = this._lastFocusableElement;\n\t\tif (lastFocusableElement) {\n\t\t\tlastFocusableElement.focus();\n\t\t}\n\n\t\tthis._lastFocusableElement = null;\n\t}\n\n\tonExitDOM() {\n\t\tremoveBodyStyles();\n\t}\n\n\tget hasHeader() {\n\t\tconst hasHeaderText = this.headerText && this.headerText.length;\n\t\treturn !!(hasHeaderText || this.header.length);\n\t}\n\n\tget hasFooter() {\n\t\treturn !!this.footer.length;\n\t}\n\n\tget role() {\n\t\treturn \"heading\";\n\t}\n}\n\nexport default Popup;\n"]},"metadata":{},"sourceType":"module"}