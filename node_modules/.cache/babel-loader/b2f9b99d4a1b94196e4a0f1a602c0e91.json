{"ast":null,"code":"import { isEscape } from \"@ui5/webcomponents-base/dist/Keys.js\";\nlet registry = [];\n\nconst addOpenedPopup = instance => {\n  if (!registry.includes(instance)) {\n    registry.push(instance);\n  }\n\n  if (registry.length === 1) {\n    attachGlobalListener();\n  }\n};\n\nconst removeOpenedPopup = instance => {\n  registry = registry.filter(el => {\n    return el !== instance;\n  });\n\n  if (!registry.length) {\n    detachGlobalListener();\n  }\n};\n\nconst getOpenedPopups = () => {\n  return [...registry];\n};\n\nconst _keydownListener = event => {\n  if (isEscape(event)) {\n    const topPopup = registry[registry.length - 1];\n    topPopup && topPopup.close();\n  }\n};\n\nconst attachGlobalListener = () => {\n  document.addEventListener(\"keydown\", _keydownListener);\n};\n\nconst detachGlobalListener = () => {\n  document.removeEventListener(\"keydown\", _keydownListener);\n};\n\nexport { addOpenedPopup, removeOpenedPopup, getOpenedPopups };","map":{"version":3,"sources":["/Users/juanzorrilla/Documents/SAPUI5/personal-ui5/node_modules/@ui5/webcomponents/dist/popup-utils/OpenedPopupsRegistry.js"],"names":["isEscape","registry","addOpenedPopup","instance","includes","push","length","attachGlobalListener","removeOpenedPopup","filter","el","detachGlobalListener","getOpenedPopups","_keydownListener","event","topPopup","close","document","addEventListener","removeEventListener"],"mappings":"AAAA,SAASA,QAAT,QAAyB,sCAAzB;AAEA,IAAIC,QAAQ,GAAG,EAAf;;AAEA,MAAMC,cAAc,GAAGC,QAAQ,IAAI;AAClC,MAAI,CAACF,QAAQ,CAACG,QAAT,CAAkBD,QAAlB,CAAL,EAAkC;AACjCF,IAAAA,QAAQ,CAACI,IAAT,CAAcF,QAAd;AACA;;AAED,MAAIF,QAAQ,CAACK,MAAT,KAAoB,CAAxB,EAA2B;AAC1BC,IAAAA,oBAAoB;AACpB;AACD,CARD;;AAUA,MAAMC,iBAAiB,GAAGL,QAAQ,IAAI;AACrCF,EAAAA,QAAQ,GAAGA,QAAQ,CAACQ,MAAT,CAAgBC,EAAE,IAAI;AAChC,WAAOA,EAAE,KAAKP,QAAd;AACA,GAFU,CAAX;;AAIA,MAAI,CAACF,QAAQ,CAACK,MAAd,EAAsB;AACrBK,IAAAA,oBAAoB;AACpB;AACD,CARD;;AAUA,MAAMC,eAAe,GAAG,MAAM;AAC7B,SAAO,CAAC,GAAGX,QAAJ,CAAP;AACA,CAFD;;AAIA,MAAMY,gBAAgB,GAAGC,KAAK,IAAI;AACjC,MAAId,QAAQ,CAACc,KAAD,CAAZ,EAAqB;AACpB,UAAMC,QAAQ,GAAGd,QAAQ,CAACA,QAAQ,CAACK,MAAT,GAAkB,CAAnB,CAAzB;AAEAS,IAAAA,QAAQ,IAAIA,QAAQ,CAACC,KAAT,EAAZ;AACA;AACD,CAND;;AAQA,MAAMT,oBAAoB,GAAG,MAAM;AAClCU,EAAAA,QAAQ,CAACC,gBAAT,CAA0B,SAA1B,EAAqCL,gBAArC;AACA,CAFD;;AAIA,MAAMF,oBAAoB,GAAG,MAAM;AAClCM,EAAAA,QAAQ,CAACE,mBAAT,CAA6B,SAA7B,EAAwCN,gBAAxC;AACA,CAFD;;AAIA,SAASX,cAAT,EAAyBM,iBAAzB,EAA4CI,eAA5C","sourcesContent":["import { isEscape } from \"@ui5/webcomponents-base/dist/Keys.js\";\n\nlet registry = [];\n\nconst addOpenedPopup = instance => {\n\tif (!registry.includes(instance)) {\n\t\tregistry.push(instance);\n\t}\n\n\tif (registry.length === 1) {\n\t\tattachGlobalListener();\n\t}\n};\n\nconst removeOpenedPopup = instance => {\n\tregistry = registry.filter(el => {\n\t\treturn el !== instance;\n\t});\n\n\tif (!registry.length) {\n\t\tdetachGlobalListener();\n\t}\n};\n\nconst getOpenedPopups = () => {\n\treturn [...registry];\n};\n\nconst _keydownListener = event => {\n\tif (isEscape(event)) {\n\t\tconst topPopup = registry[registry.length - 1];\n\n\t\ttopPopup && topPopup.close();\n\t}\n};\n\nconst attachGlobalListener = () => {\n\tdocument.addEventListener(\"keydown\", _keydownListener);\n};\n\nconst detachGlobalListener = () => {\n\tdocument.removeEventListener(\"keydown\", _keydownListener);\n};\n\nexport { addOpenedPopup, removeOpenedPopup, getOpenedPopups };\n"]},"metadata":{},"sourceType":"module"}