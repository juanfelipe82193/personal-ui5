{"ast":null,"code":"import _regeneratorRuntime from \"/Users/juanzorrilla/Documents/SAPUI5/personal-ui5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/juanzorrilla/Documents/SAPUI5/personal-ui5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/juanzorrilla/Documents/SAPUI5/personal-ui5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/juanzorrilla/Documents/SAPUI5/personal-ui5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/juanzorrilla/Documents/SAPUI5/personal-ui5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/juanzorrilla/Documents/SAPUI5/personal-ui5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/Users/juanzorrilla/Documents/SAPUI5/personal-ui5/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport RenderScheduler from \"../RenderScheduler.js\";\nimport { isDown, isUp, isLeft, isRight, isHome, isEnd } from \"../Keys.js\";\nimport EventProvider from \"../EventProvider.js\";\nimport UI5Element from \"../UI5Element.js\";\nimport NavigationMode from \"../types/NavigationMode.js\";\nimport ItemNavigationBehavior from \"../types/ItemNavigationBehavior.js\"; // navigatable items must have id and tabindex\n\nvar ItemNavigation = /*#__PURE__*/function (_EventProvider) {\n  _inherits(ItemNavigation, _EventProvider);\n\n  var _super = _createSuper(ItemNavigation);\n\n  function ItemNavigation(rootWebComponent) {\n    var _this;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, ItemNavigation);\n\n    _this = _super.call(this);\n    _this.currentIndex = options.currentIndex || 0;\n    _this.rowSize = options.rowSize || 1;\n    _this.behavior = options.behavior || ItemNavigationBehavior.Static;\n    _this.hasNextPage = true; // used in Paging mode and controlled from the rootWebComponent\n\n    _this.hasPrevPage = true; // used in Paging mode and controlled from the rootWebComponent\n\n    var navigationMode = options.navigationMode;\n    var autoNavigation = !navigationMode || navigationMode === NavigationMode.Auto;\n    _this.horizontalNavigationOn = autoNavigation || navigationMode === NavigationMode.Horizontal;\n    _this.verticalNavigationOn = autoNavigation || navigationMode === NavigationMode.Vertical;\n    _this.rootWebComponent = rootWebComponent;\n\n    _this.rootWebComponent.addEventListener(\"keydown\", _this.onkeydown.bind(_assertThisInitialized(_this)));\n\n    _this.rootWebComponent._onComponentStateFinalized = function () {\n      _this._init();\n    };\n\n    return _this;\n  }\n\n  _createClass(ItemNavigation, [{\n    key: \"_init\",\n    value: function _init() {\n      var _this2 = this;\n\n      this._getItems().forEach(function (item, idx) {\n        item._tabIndex = idx === _this2.currentIndex ? \"0\" : \"-1\";\n      });\n    }\n  }, {\n    key: \"_horizontalNavigationOn\",\n    value: function _horizontalNavigationOn() {\n      return this.horizontalNavigationOn;\n    }\n  }, {\n    key: \"_verticalNavigationOn\",\n    value: function _verticalNavigationOn() {\n      return this.verticalNavigationOn;\n    }\n  }, {\n    key: \"_onKeyPress\",\n    value: function () {\n      var _onKeyPress2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (this.currentIndex >= this._getItems().length) {\n                  this.onOverflowBottomEdge();\n                } else if (this.currentIndex < 0) {\n                  this.onOverflowTopEdge();\n                }\n\n                event.preventDefault();\n                _context.next = 4;\n                return RenderScheduler.whenFinished();\n\n              case 4:\n                this.update();\n                this.focusCurrent();\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function _onKeyPress(_x) {\n        return _onKeyPress2.apply(this, arguments);\n      }\n\n      return _onKeyPress;\n    }()\n  }, {\n    key: \"onkeydown\",\n    value: function onkeydown(event) {\n      if (isUp(event) && this._verticalNavigationOn()) {\n        return this._handleUp(event);\n      }\n\n      if (isDown(event) && this._verticalNavigationOn()) {\n        return this._handleDown(event);\n      }\n\n      if (isLeft(event) && this._horizontalNavigationOn()) {\n        return this._handleLeft(event);\n      }\n\n      if (isRight(event) && this._horizontalNavigationOn()) {\n        return this._handleRight(event);\n      }\n\n      if (isHome(event)) {\n        return this._handleHome(event);\n      }\n\n      if (isEnd(event)) {\n        return this._handleEnd(event);\n      }\n    }\n  }, {\n    key: \"_handleUp\",\n    value: function _handleUp(event) {\n      if (this._canNavigate()) {\n        this.currentIndex -= this.rowSize;\n\n        this._onKeyPress(event);\n      }\n    }\n  }, {\n    key: \"_handleDown\",\n    value: function _handleDown(event) {\n      if (this._canNavigate()) {\n        this.currentIndex += this.rowSize;\n\n        this._onKeyPress(event);\n      }\n    }\n  }, {\n    key: \"_handleLeft\",\n    value: function _handleLeft(event) {\n      if (this._canNavigate()) {\n        this.currentIndex -= 1;\n\n        this._onKeyPress(event);\n      }\n    }\n  }, {\n    key: \"_handleRight\",\n    value: function _handleRight(event) {\n      if (this._canNavigate()) {\n        this.currentIndex += 1;\n\n        this._onKeyPress(event);\n      }\n    }\n  }, {\n    key: \"_handleHome\",\n    value: function _handleHome(event) {\n      if (this._canNavigate()) {\n        var homeEndRange = this.rowSize > 1 ? this.rowSize : this._getItems().length;\n        this.currentIndex -= this.currentIndex % homeEndRange;\n\n        this._onKeyPress(event);\n      }\n    }\n  }, {\n    key: \"_handleEnd\",\n    value: function _handleEnd(event) {\n      if (this._canNavigate()) {\n        var homeEndRange = this.rowSize > 1 ? this.rowSize : this._getItems().length;\n        this.currentIndex += homeEndRange - 1 - this.currentIndex % homeEndRange; // eslint-disable-line\n\n        this._onKeyPress(event);\n      }\n    }\n  }, {\n    key: \"update\",\n    value: function update(current) {\n      var origItems = this._getItems();\n\n      if (current) {\n        this.currentIndex = this._getItems().indexOf(current);\n      }\n\n      if (!origItems[this.currentIndex] || origItems[this.currentIndex]._tabIndex && origItems[this.currentIndex]._tabIndex === \"0\") {\n        return;\n      }\n\n      var items = origItems.slice(0);\n\n      for (var i = 0; i < items.length; i++) {\n        items[i]._tabIndex = i === this.currentIndex ? \"0\" : \"-1\";\n      }\n\n      this.rootWebComponent._invalidate();\n    }\n  }, {\n    key: \"focusCurrent\",\n    value: function focusCurrent() {\n      var currentItem = this._getCurrentItem();\n\n      if (currentItem) {\n        currentItem.focus();\n      }\n    }\n  }, {\n    key: \"_canNavigate\",\n    value: function _canNavigate() {\n      var currentItem = this._getCurrentItem();\n\n      var activeElement = document.activeElement;\n\n      while (activeElement.shadowRoot && activeElement.shadowRoot.activeElement) {\n        activeElement = activeElement.shadowRoot.activeElement;\n      }\n\n      return currentItem && currentItem === activeElement;\n    }\n  }, {\n    key: \"_getCurrentItem\",\n    value: function _getCurrentItem() {\n      var items = this._getItems();\n\n      if (!items.length) {\n        return null;\n      } // normalize the index\n\n\n      while (this.currentIndex >= items.length) {\n        this.currentIndex -= this.rowSize;\n      }\n\n      if (this.currentIndex < 0) {\n        this.currentIndex = 0;\n      }\n\n      var currentItem = items[this.currentIndex];\n\n      if (currentItem instanceof UI5Element) {\n        return currentItem.getFocusDomRef();\n      }\n\n      if (!this.rootWebComponent.getDomRef()) {\n        return;\n      }\n\n      return this.rootWebComponent.getDomRef().querySelector(\"#\".concat(currentItem.id));\n    }\n  }, {\n    key: \"onOverflowBottomEdge\",\n    value: function onOverflowBottomEdge() {\n      var items = this._getItems();\n\n      var offset = this.currentIndex - items.length;\n\n      if (this.behavior === ItemNavigationBehavior.Cyclic) {\n        this.currentIndex = 0;\n        return;\n      }\n\n      if (this.behavior === ItemNavigationBehavior.Paging) {\n        this._handleNextPage();\n      } else {\n        this.currentIndex = items.length - 1;\n      }\n\n      this.fireEvent(ItemNavigation.BORDER_REACH, {\n        start: false,\n        end: true,\n        offset: offset\n      });\n    }\n  }, {\n    key: \"onOverflowTopEdge\",\n    value: function onOverflowTopEdge() {\n      var items = this._getItems();\n\n      var offset = this.currentIndex + this.rowSize;\n\n      if (this.behavior === ItemNavigationBehavior.Cyclic) {\n        this.currentIndex = items.length - 1;\n        return;\n      }\n\n      if (this.behavior === ItemNavigationBehavior.Paging) {\n        this._handlePrevPage();\n      } else {\n        this.currentIndex = 0;\n      }\n\n      this.fireEvent(ItemNavigation.BORDER_REACH, {\n        start: true,\n        end: false,\n        offset: offset\n      });\n    }\n  }, {\n    key: \"_handleNextPage\",\n    value: function _handleNextPage() {\n      this.fireEvent(ItemNavigation.PAGE_BOTTOM);\n\n      var items = this._getItems();\n\n      if (!this.hasNextPage) {\n        this.currentIndex = items.length - 1;\n      } else {\n        this.currentIndex = 0;\n      }\n    }\n  }, {\n    key: \"_handlePrevPage\",\n    value: function _handlePrevPage() {\n      this.fireEvent(ItemNavigation.PAGE_TOP);\n\n      var items = this._getItems();\n\n      if (!this.hasPrevPage) {\n        this.currentIndex = 0;\n      } else {\n        this.currentIndex = (this.pageSize || items.length) - 1;\n      }\n    }\n  }, {\n    key: \"getItemsCallback\",\n    set: function set(fn) {\n      this._getItems = fn;\n    }\n  }, {\n    key: \"current\",\n    set: function set(val) {\n      this.currentIndex = val;\n    }\n  }]);\n\n  return ItemNavigation;\n}(EventProvider);\n\nItemNavigation.PAGE_TOP = \"PageTop\";\nItemNavigation.PAGE_BOTTOM = \"PageBottom\";\nItemNavigation.BORDER_REACH = \"_borderReach\";\nexport default ItemNavigation;","map":{"version":3,"sources":["/Users/juanzorrilla/Documents/SAPUI5/personal-ui5/node_modules/@ui5/webcomponents-base/dist/delegate/ItemNavigation.js"],"names":["RenderScheduler","isDown","isUp","isLeft","isRight","isHome","isEnd","EventProvider","UI5Element","NavigationMode","ItemNavigationBehavior","ItemNavigation","rootWebComponent","options","currentIndex","rowSize","behavior","Static","hasNextPage","hasPrevPage","navigationMode","autoNavigation","Auto","horizontalNavigationOn","Horizontal","verticalNavigationOn","Vertical","addEventListener","onkeydown","bind","_onComponentStateFinalized","_init","_getItems","forEach","item","idx","_tabIndex","event","length","onOverflowBottomEdge","onOverflowTopEdge","preventDefault","whenFinished","update","focusCurrent","_verticalNavigationOn","_handleUp","_handleDown","_horizontalNavigationOn","_handleLeft","_handleRight","_handleHome","_handleEnd","_canNavigate","_onKeyPress","homeEndRange","current","origItems","indexOf","items","slice","i","_invalidate","currentItem","_getCurrentItem","focus","activeElement","document","shadowRoot","getFocusDomRef","getDomRef","querySelector","id","offset","Cyclic","Paging","_handleNextPage","fireEvent","BORDER_REACH","start","end","_handlePrevPage","PAGE_BOTTOM","PAGE_TOP","pageSize","fn","val"],"mappings":"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","sourcesContent":["import RenderScheduler from \"../RenderScheduler.js\";\nimport {\n\tisDown,\n\tisUp,\n\tisLeft,\n\tisRight,\n\tisHome,\n\tisEnd,\n} from \"../Keys.js\";\n\nimport EventProvider from \"../EventProvider.js\";\nimport UI5Element from \"../UI5Element.js\";\nimport NavigationMode from \"../types/NavigationMode.js\";\nimport ItemNavigationBehavior from \"../types/ItemNavigationBehavior.js\";\n\n// navigatable items must have id and tabindex\nclass ItemNavigation extends EventProvider {\n\tconstructor(rootWebComponent, options = {}) {\n\t\tsuper();\n\n\t\tthis.currentIndex = options.currentIndex || 0;\n\t\tthis.rowSize = options.rowSize || 1;\n\t\tthis.behavior = options.behavior || ItemNavigationBehavior.Static;\n\t\tthis.hasNextPage = true; // used in Paging mode and controlled from the rootWebComponent\n\t\tthis.hasPrevPage = true; // used in Paging mode and controlled from the rootWebComponent\n\t\tconst navigationMode = options.navigationMode;\n\t\tconst autoNavigation = !navigationMode || navigationMode === NavigationMode.Auto;\n\t\tthis.horizontalNavigationOn = autoNavigation || navigationMode === NavigationMode.Horizontal;\n\t\tthis.verticalNavigationOn = autoNavigation || navigationMode === NavigationMode.Vertical;\n\n\t\tthis.rootWebComponent = rootWebComponent;\n\t\tthis.rootWebComponent.addEventListener(\"keydown\", this.onkeydown.bind(this));\n\t\tthis.rootWebComponent._onComponentStateFinalized = () => {\n\t\t\tthis._init();\n\t\t};\n\t}\n\n\t_init() {\n\t\tthis._getItems().forEach((item, idx) => {\n\t\t\titem._tabIndex = (idx === this.currentIndex) ? \"0\" : \"-1\";\n\t\t});\n\t}\n\n\t_horizontalNavigationOn() {\n\t\treturn this.horizontalNavigationOn;\n\t}\n\n\t_verticalNavigationOn() {\n\t\treturn this.verticalNavigationOn;\n\t}\n\n\tasync _onKeyPress(event) {\n\t\tif (this.currentIndex >= this._getItems().length) {\n\t\t\tthis.onOverflowBottomEdge();\n\t\t} else if (this.currentIndex < 0) {\n\t\t\tthis.onOverflowTopEdge();\n\t\t}\n\n\t\tevent.preventDefault();\n\n\t\tawait RenderScheduler.whenFinished();\n\n\t\tthis.update();\n\t\tthis.focusCurrent();\n\t}\n\n\tonkeydown(event) {\n\t\tif (isUp(event) && this._verticalNavigationOn()) {\n\t\t\treturn this._handleUp(event);\n\t\t}\n\n\t\tif (isDown(event) && this._verticalNavigationOn()) {\n\t\t\treturn this._handleDown(event);\n\t\t}\n\n\t\tif (isLeft(event) && this._horizontalNavigationOn()) {\n\t\t\treturn this._handleLeft(event);\n\t\t}\n\n\t\tif (isRight(event) && this._horizontalNavigationOn()) {\n\t\t\treturn this._handleRight(event);\n\t\t}\n\n\t\tif (isHome(event)) {\n\t\t\treturn this._handleHome(event);\n\t\t}\n\n\t\tif (isEnd(event)) {\n\t\t\treturn this._handleEnd(event);\n\t\t}\n\t}\n\n\t_handleUp(event) {\n\t\tif (this._canNavigate()) {\n\t\t\tthis.currentIndex -= this.rowSize;\n\t\t\tthis._onKeyPress(event);\n\t\t}\n\t}\n\n\t_handleDown(event) {\n\t\tif (this._canNavigate()) {\n\t\t\tthis.currentIndex += this.rowSize;\n\t\t\tthis._onKeyPress(event);\n\t\t}\n\t}\n\n\t_handleLeft(event) {\n\t\tif (this._canNavigate()) {\n\t\t\tthis.currentIndex -= 1;\n\t\t\tthis._onKeyPress(event);\n\t\t}\n\t}\n\n\t_handleRight(event) {\n\t\tif (this._canNavigate()) {\n\t\t\tthis.currentIndex += 1;\n\t\t\tthis._onKeyPress(event);\n\t\t}\n\t}\n\n\t_handleHome(event) {\n\t\tif (this._canNavigate()) {\n\t\t\tconst homeEndRange = this.rowSize > 1 ? this.rowSize : this._getItems().length;\n\t\t\tthis.currentIndex -= this.currentIndex % homeEndRange;\n\t\t\tthis._onKeyPress(event);\n\t\t}\n\t}\n\n\t_handleEnd(event) {\n\t\tif (this._canNavigate()) {\n\t\t\tconst homeEndRange = this.rowSize > 1 ? this.rowSize : this._getItems().length;\n\t\t\tthis.currentIndex += (homeEndRange - 1 - this.currentIndex % homeEndRange); // eslint-disable-line\n\t\t\tthis._onKeyPress(event);\n\t\t}\n\t}\n\n\tupdate(current) {\n\t\tconst origItems = this._getItems();\n\n\t\tif (current) {\n\t\t\tthis.currentIndex = this._getItems().indexOf(current);\n\t\t}\n\n\t\tif (!origItems[this.currentIndex]\n\t\t\t|| (origItems[this.currentIndex]._tabIndex && origItems[this.currentIndex]._tabIndex === \"0\")) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst items = origItems.slice(0);\n\n\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\titems[i]._tabIndex = (i === this.currentIndex ? \"0\" : \"-1\");\n\t\t}\n\n\n\t\tthis.rootWebComponent._invalidate();\n\t}\n\n\tfocusCurrent() {\n\t\tconst currentItem = this._getCurrentItem();\n\t\tif (currentItem) {\n\t\t\tcurrentItem.focus();\n\t\t}\n\t}\n\n\t_canNavigate() {\n\t\tconst currentItem = this._getCurrentItem();\n\n\t\tlet activeElement = document.activeElement;\n\n\t\twhile (activeElement.shadowRoot && activeElement.shadowRoot.activeElement) {\n\t\t\tactiveElement = activeElement.shadowRoot.activeElement;\n\t\t}\n\n\t\treturn currentItem && currentItem === activeElement;\n\t}\n\n\t_getCurrentItem() {\n\t\tconst items = this._getItems();\n\n\t\tif (!items.length) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// normalize the index\n\t\twhile (this.currentIndex >= items.length) {\n\t\t\tthis.currentIndex -= this.rowSize;\n\t\t}\n\n\t\tif (this.currentIndex < 0) {\n\t\t\tthis.currentIndex = 0;\n\t\t}\n\n\t\tconst currentItem = items[this.currentIndex];\n\n\t\tif (currentItem instanceof UI5Element) {\n\t\t\treturn currentItem.getFocusDomRef();\n\t\t}\n\n\t\tif (!this.rootWebComponent.getDomRef()) {\n\t\t\treturn;\n\t\t}\n\n\t\treturn this.rootWebComponent.getDomRef().querySelector(`#${currentItem.id}`);\n\t}\n\n\tset getItemsCallback(fn) {\n\t\tthis._getItems = fn;\n\t}\n\n\tset current(val) {\n\t\tthis.currentIndex = val;\n\t}\n\n\tonOverflowBottomEdge() {\n\t\tconst items = this._getItems();\n\t\tconst offset = this.currentIndex - items.length;\n\n\t\tif (this.behavior === ItemNavigationBehavior.Cyclic) {\n\t\t\tthis.currentIndex = 0;\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.behavior === ItemNavigationBehavior.Paging) {\n\t\t\tthis._handleNextPage();\n\t\t} else {\n\t\t\tthis.currentIndex = items.length - 1;\n\t\t}\n\n\t\tthis.fireEvent(ItemNavigation.BORDER_REACH, { start: false, end: true, offset });\n\t}\n\n\tonOverflowTopEdge() {\n\t\tconst items = this._getItems();\n\t\tconst offset = this.currentIndex + this.rowSize;\n\n\t\tif (this.behavior === ItemNavigationBehavior.Cyclic) {\n\t\t\tthis.currentIndex = items.length - 1;\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.behavior === ItemNavigationBehavior.Paging) {\n\t\t\tthis._handlePrevPage();\n\t\t} else {\n\t\t\tthis.currentIndex = 0;\n\t\t}\n\n\t\tthis.fireEvent(ItemNavigation.BORDER_REACH, { start: true, end: false, offset });\n\t}\n\n\t_handleNextPage() {\n\t\tthis.fireEvent(ItemNavigation.PAGE_BOTTOM);\n\t\tconst items = this._getItems();\n\n\t\tif (!this.hasNextPage) {\n\t\t\tthis.currentIndex = items.length - 1;\n\t\t} else {\n\t\t\tthis.currentIndex = 0;\n\t\t}\n\t}\n\n\t_handlePrevPage() {\n\t\tthis.fireEvent(ItemNavigation.PAGE_TOP);\n\t\tconst items = this._getItems();\n\n\t\tif (!this.hasPrevPage) {\n\t\t\tthis.currentIndex = 0;\n\t\t} else {\n\t\t\tthis.currentIndex = (this.pageSize || items.length) - 1;\n\t\t}\n\t}\n}\n\nItemNavigation.PAGE_TOP = \"PageTop\";\nItemNavigation.PAGE_BOTTOM = \"PageBottom\";\nItemNavigation.BORDER_REACH = \"_borderReach\";\n\nexport default ItemNavigation;\n"]},"metadata":{},"sourceType":"module"}