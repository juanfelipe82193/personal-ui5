{"version":3,"file":"react-virtual.mjs","sources":["../src/useIsomorphicLayoutEffect.js","../src/useScroll.js","../node_modules/@reach/observe-rect/dist/observe-rect.esm.js","../src/useRect.js","../src/index.js"],"sourcesContent":["import React from 'react'\n\nexport default typeof window !== 'undefined'\n  ? React.useLayoutEffect\n  : React.useEffect\n","import React from 'react'\n\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect'\n\nexport default function useScroll(nodeRef, onChange) {\n  const [element, setElement] = React.useState(nodeRef.current)\n  const onChangeRef = React.useRef()\n  onChangeRef.current = onChange\n\n  useIsomorphicLayoutEffect(() => {\n    if (nodeRef.current !== element) {\n      setElement(nodeRef.current)\n    }\n  })\n\n  useIsomorphicLayoutEffect(() => {\n    if (element) {\n      onChangeRef.current({\n        scrollLeft: element.scrollLeft,\n        scrollTop: element.scrollTop,\n      })\n    }\n  }, [element])\n\n  React.useEffect(() => {\n    const handler = e => {\n      onChangeRef.current({\n        scrollLeft: e.target.scrollLeft,\n        scrollTop: e.target.scrollTop,\n      })\n    }\n\n    if (element) {\n      element.addEventListener('scroll', handler, {\n        capture: false,\n        passive: true,\n      })\n\n      return () => {\n        element.removeEventListener('scroll', handler)\n      }\n    }\n  }, [element])\n}\n","var props = ['bottom', 'height', 'left', 'right', 'top', 'width'];\n\nvar rectChanged = function rectChanged(a, b) {\n  if (a === void 0) {\n    a = {};\n  }\n\n  if (b === void 0) {\n    b = {};\n  }\n\n  return props.some(function (prop) {\n    return a[prop] !== b[prop];\n  });\n};\n\nvar observedNodes =\n/*#__PURE__*/\nnew Map();\nvar rafId;\n\nvar run = function run() {\n  var changedStates = [];\n  observedNodes.forEach(function (state, node) {\n    var newRect = node.getBoundingClientRect();\n\n    if (rectChanged(newRect, state.rect)) {\n      state.rect = newRect;\n      changedStates.push(state);\n    }\n  });\n  changedStates.forEach(function (state) {\n    state.callbacks.forEach(function (cb) {\n      return cb(state.rect);\n    });\n  });\n  rafId = window.requestAnimationFrame(run);\n};\n\nfunction observeRect(node, cb) {\n  return {\n    observe: function observe() {\n      var wasEmpty = observedNodes.size === 0;\n\n      if (observedNodes.has(node)) {\n        observedNodes.get(node).callbacks.push(cb);\n      } else {\n        observedNodes.set(node, {\n          rect: undefined,\n          hasRectChanged: false,\n          callbacks: [cb]\n        });\n      }\n\n      if (wasEmpty) run();\n    },\n    unobserve: function unobserve() {\n      var state = observedNodes.get(node);\n\n      if (state) {\n        // Remove the callback\n        var index = state.callbacks.indexOf(cb);\n        if (index >= 0) state.callbacks.splice(index, 1); // Remove the node reference\n\n        if (!state.callbacks.length) observedNodes[\"delete\"](node); // Stop the loop\n\n        if (!observedNodes.size) cancelAnimationFrame(rafId);\n      }\n    }\n  };\n}\n\nexport default observeRect;\n//# sourceMappingURL=observe-rect.esm.js.map\n","import React from 'react'\n\nimport observeRect from '@reach/observe-rect'\n\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect'\n\nexport default function useRect(nodeRef) {\n  const [element, setElement] = React.useState(nodeRef.current)\n  const [rect, setRect] = React.useState(null)\n  const initialRectSet = React.useRef(false)\n\n  useIsomorphicLayoutEffect(() => {\n    if (nodeRef.current !== element) {\n      setElement(nodeRef.current)\n    }\n  })\n\n  useIsomorphicLayoutEffect(() => {\n    if (element && !initialRectSet.current) {\n      initialRectSet.current = true\n      setRect(element.getBoundingClientRect())\n    }\n  }, [element])\n\n  React.useEffect(() => {\n    let observer\n\n    if (element) {\n      observer = observeRect(element, setRect)\n    }\n\n    observer && observer.observe()\n\n    return () => {\n      observer && observer.unobserve()\n    }\n  }, [element])\n\n  return rect\n}\n","import React from 'react'\n\nimport useScroll from './useScroll'\nimport useRect from './useRect'\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect'\n\nexport function useVirtual({\n  size = 0,\n  estimateSize,\n  overscan = 0,\n  parentRef,\n  horizontal,\n  scrollToFn,\n}) {\n  const sizeKey = horizontal ? 'width' : 'height'\n  const scrollKey = horizontal ? 'scrollLeft' : 'scrollTop'\n\n  const defaultScrollToFn = React.useCallback(\n    offset => {\n      parentRef.current[scrollKey] = offset\n    },\n    [parentRef, scrollKey]\n  )\n\n  scrollToFn = scrollToFn || defaultScrollToFn\n\n  const { [sizeKey]: outerSize } = useRect(parentRef) || {\n    [sizeKey]: 0,\n  }\n\n  const [scrollOffset, _setScrollOffset] = React.useState(0)\n\n  useScroll(parentRef, ({ [scrollKey]: newScrollOffset }) => {\n    _setScrollOffset(newScrollOffset)\n  })\n\n  const scrollOffsetPlusOuterSize = scrollOffset + outerSize\n\n  const [measuredCache, setMeasuredCache] = React.useState({})\n\n  const mountedRef = React.useRef()\n\n  useIsomorphicLayoutEffect(() => {\n    if (mountedRef.current) {\n      if (estimateSize || size) setMeasuredCache({})\n    }\n    mountedRef.current = true\n  }, [estimateSize, size])\n\n  const { measurements, reversedMeasurements } = React.useMemo(() => {\n    const measurements = []\n    const reversedMeasurements = []\n\n    for (let i = 0, j = size - 1; i < size; i++, j--) {\n      const start = measurements[i - 1]?.end || 0\n      const size = measuredCache[i] || estimateSize(i)\n      const end = start + size\n      const bounds = { index: i, start, size, end }\n      measurements[i] = {\n        ...bounds,\n      }\n      reversedMeasurements[j] = {\n        ...bounds,\n      }\n    }\n    return { measurements, reversedMeasurements }\n  }, [estimateSize, measuredCache, size])\n\n  const totalSize = measurements[size - 1]?.end || 0\n\n  let start = React.useMemo(\n    () => measurements.find(rowStat => rowStat.end >= scrollOffset),\n    [measurements, scrollOffset]\n  )\n  let end = React.useMemo(\n    () =>\n      reversedMeasurements.find(\n        rowStat => rowStat.start <= scrollOffsetPlusOuterSize\n      ),\n    [measurements, scrollOffsetPlusOuterSize]\n  )\n\n  let startIndex = start ? start.index : 0\n  let endIndex = end ? end.index : 0\n\n  // Always add at least one overscan item, so focus will work\n  startIndex = Math.max(startIndex - 1 - overscan, 0)\n  endIndex = Math.min(endIndex + 1 + overscan, size - 1)\n\n  const virtualItems = React.useMemo(() => {\n    const virtualItems = []\n\n    for (let i = startIndex; i <= endIndex; i++) {\n      const measurement = measurements[i]\n\n      const item = {\n        ...measurement,\n        measureRef: el => {\n          if (!el) return\n\n          const { [sizeKey]: measuredSize } = el.getBoundingClientRect()\n\n          if (measuredSize !== item.size) {\n            setMeasuredCache(old => ({\n              ...old,\n              [i]: measuredSize,\n            }))\n          }\n        },\n      }\n\n      virtualItems.push(item)\n    }\n\n    return virtualItems\n  }, [startIndex, endIndex, measurements, sizeKey])\n\n  const latestRef = React.useRef()\n  latestRef.current = {\n    measurements,\n    outerSize,\n    scrollOffset,\n    scrollOffsetPlusOuterSize,\n    totalSize,\n  }\n\n  const scrollToOffset = React.useCallback(\n    (offset, { align = 'start' } = {}) => {\n      const {\n        outerSize,\n        scrollOffset,\n        scrollOffsetPlusOuterSize,\n        totalSize,\n      } = latestRef.current\n\n      offset = Math.max(0, Math.min(offset, totalSize - outerSize))\n\n      if (align === 'auto') {\n        if (offset <= scrollOffset) {\n          align = 'start'\n        } else if (offset >= scrollOffsetPlusOuterSize) {\n          align = 'end'\n        } else {\n          align = 'start'\n        }\n      }\n\n      if (align === 'start') {\n        scrollToFn(offset)\n      } else if (align === 'end') {\n        scrollToFn(offset - outerSize)\n      } else if (align === 'center') {\n        scrollToFn(offset - outerSize / 2)\n      }\n    },\n    [scrollToFn]\n  )\n\n  const scrollToIndex = React.useCallback(\n    (index, { align = 'auto' } = {}) => {\n      const {\n        measurements,\n        scrollOffset,\n        scrollOffsetPlusOuterSize,\n      } = latestRef.current\n\n      const measurement = measurements[index]\n\n      if (!measurement) {\n        return\n      }\n\n      if (align === 'auto') {\n        if (measurement.end >= scrollOffsetPlusOuterSize) {\n          align = 'end'\n        } else if (measurement.start <= scrollOffset) {\n          align = 'start'\n        } else {\n          return\n        }\n      }\n\n      let offset =\n        align === 'center'\n          ? measurement.start + measurement.size / 2\n          : align === 'end'\n          ? measurement.end\n          : measurement.start\n      scrollToOffset(offset, { align })\n    },\n    [scrollToOffset]\n  )\n\n  return {\n    virtualItems,\n    totalSize,\n    scrollToOffset,\n    scrollToIndex,\n  }\n}\n"],"names":["window","React","useLayoutEffect","useEffect","useScroll","nodeRef","onChange","useState","current","element","setElement","onChangeRef","useRef","useIsomorphicLayoutEffect","scrollLeft","scrollTop","handler","e","target","addEventListener","capture","passive","removeEventListener","props","rectChanged","b","observedNodes","run","changedStates","newRect","node","state","rafId","observeRect","cb","observe","wasEmpty","rect","hasRectChanged","callbacks","unobserve","index","cancelAnimationFrame","useRect","setRect","initialRectSet","getBoundingClientRect","observer","useVirtual","size","estimateSize","overscan","parentRef","horizontal","scrollToFn","sizeKey","scrollKey","defaultScrollToFn","useCallback","offset","outerSize","scrollOffset","_setScrollOffset","newScrollOffset","scrollOffsetPlusOuterSize","measuredCache","setMeasuredCache","mountedRef","useMemo","measurements","reversedMeasurements","i","j","start","end","bounds","totalSize","find","rowStat","startIndex","endIndex","Math","max","min","virtualItems","measurement","item","measureRef","el","measuredSize","old","push","latestRef","scrollToOffset","align","scrollToIndex"],"mappings":"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"}